\resizebox{0.8\linewidth}{!}{\scriptsize%
\begin{tikzpicture}[%
    item/.style={circle,draw,align=center,minimum width=1.5cm},
    itemc/.style={item,on chain,join},scale=0.5,
]

    \node[item] (At-1) {$\h^{(k-2)}$};
    \node[right=2em of At-1,item] (At) {$\h^{(k-1)}$};
    \node[right=2em of At,item] (At+1) {$\h^{(k)}$};


    \draw[<-,dashed] (At-1) -- ++(-3,0);
    \draw[->] (At-1) -- (At)
        node[midway,above] (W) {};
    \draw[->] (At) -- (At+1)
        node[midway,above] (W) {};

    \draw[<-] (At-1.south) -- ++ (0,-2em)
        node[below,item] (x1) {$\x^{(k-2)}$};
    \draw[<-] (At.south) -- ++ (0,-2em)
        node[below,item] (x2) {$\x^{(k-1)}$};
    \draw[<-] (At+1.south) -- ++ (0,-2em)
        node[below,item] (x3) {$\x^{(k)}$};

    \node[below right=4em of At+1,rectangle,draw=black] (feat) {Feture Vector};


    \node[above right=4em of feat,item] (Bt-1) {$\h^{(1)}$};
    \node[right=2em of Bt-1,item] (Bt) {$\h^{(2)}$};
    \node[right=2em of Bt,item] (Bt+1) {$\h^{(3)}$};

    \draw[->] (Bt-1) -- (Bt)
        node[midway,above] (W) {};
    \draw[->] (Bt) -- (Bt+1)
        node[midway,above] (W) {};
    \draw[->,dashed] (Bt+1) -- ++(+2,0) node[right] (end) {};

    \draw[->] (Bt-1.north) -- ++ (0,2em) node[above,item] (h1) {$\hat{\y}^{(1)}$};
    \draw[->] (Bt.north) -- ++ (0,2em) node[above,item] (h2) {$\hat{\y}^{(2)}$};
    \draw[->] (Bt+1.north) -- ++ (0,2em) node[above,item] (h3) {$\hat{\y}^{(3)}$};


    \draw[->] (h1) -- (Bt);
    \draw[->] (h2) -- (Bt+1);
    \draw[->,dashed] (h3) -- (end);

    \draw[->] (At+1.east) to [out=0,in=120] (feat.north);
    \draw[->] (feat.east) to [out=0,in=235] (Bt-1.south west);
    \draw[->] (feat.east) to [out=0,in=235] (Bt.south west);
    \draw[->] (feat.east) to [out=0,in=235] (Bt+1.south west);
    \draw[->,dashed] (feat.east) to [out=0,in=235] (end);
\end{tikzpicture}
}
